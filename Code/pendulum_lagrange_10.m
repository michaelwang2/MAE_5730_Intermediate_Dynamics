function zdot = pendulum_lagrange_10(t, z, p)
th1 = z(1); th2 = z(2); th3 = z(3); th4 = z(4); th5 = z(5); th6 = z(6); th7 = z(7); th8 = z(8); th9 = z(9); th10 = z(10); 
thd1 = z(11); thd2 = z(12); thd3 = z(13); thd4 = z(14); thd5 = z(15); thd6 = z(16); thd7 = z(17); thd8 = z(18); thd9 = z(19); thd10 = z(20); 
m1 = p.m(1); m2 = p.m(2); m3 = p.m(3); m4 = p.m(4); m5 = p.m(5); m6 = p.m(6); m7 = p.m(7); m8 = p.m(8); m9 = p.m(9); m10 = p.m(10); 
l1 = p.l(1); l2 = p.l(2); l3 = p.l(3); l4 = p.l(4); l5 = p.l(5); l6 = p.l(6); l7 = p.l(7); l8 = p.l(8); l9 = p.l(9); l10 = p.l(10); 
I1 = p.I(1); I2 = p.I(2); I3 = p.I(3); I4 = p.I(4); I5 = p.I(5); I6 = p.I(6); I7 = p.I(7); I8 = p.I(8); I9 = p.I(9); I10 = p.I(10); 
g = p.g;

A = zeros(10, 10);
b = zeros(10, 1);
A(1, 1) = I1 + (l1^2*m1)/4 + l1^2*m2 + l1^2*m3 + l1^2*m4 + l1^2*m5 + l1^2*m6 + l1^2*m7 + l1^2*m8 + l1^2*m9 + l1^2*m10;
A(1, 2) = (l1*l2*cos(th1 - th2)*(m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(1, 3) = (l1*l3*cos(th1 - th3)*(m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(1, 4) = (l1*l4*cos(th1 - th4)*(m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(1, 5) = (l1*l5*cos(th1 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(1, 6) = (l1*l6*cos(th1 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(1, 7) = (l1*l7*cos(th1 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(1, 8) = (l1*l8*cos(th1 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(1, 9) = (l1*l9*cos(th1 - th9)*(m9 + 2*m10))/2;
A(1, 10) = (l1*l10*m10*cos(th1 - th10))/2;
A(2, 1) = (l1*l2*cos(th1 - th2)*(m2 + 2*m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(2, 2) = I2 + (l2^2*m2)/4 + l2^2*m3 + l2^2*m4 + l2^2*m5 + l2^2*m6 + l2^2*m7 + l2^2*m8 + l2^2*m9 + l2^2*m10;
A(2, 3) = (l2*l3*cos(th2 - th3)*(m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(2, 4) = (l2*l4*cos(th2 - th4)*(m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(2, 5) = (l2*l5*cos(th2 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(2, 6) = (l2*l6*cos(th2 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(2, 7) = (l2*l7*cos(th2 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(2, 8) = (l2*l8*cos(th2 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(2, 9) = (l2*l9*cos(th2 - th9)*(m9 + 2*m10))/2;
A(2, 10) = (l2*l10*m10*cos(th2 - th10))/2;
A(3, 1) = (l1*l3*cos(th1 - th3)*(m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(3, 2) = (l2*l3*cos(th2 - th3)*(m3 + 2*m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(3, 3) = I3 + (l3^2*m3)/4 + l3^2*m4 + l3^2*m5 + l3^2*m6 + l3^2*m7 + l3^2*m8 + l3^2*m9 + l3^2*m10;
A(3, 4) = (l3*l4*cos(th3 - th4)*(m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(3, 5) = (l3*l5*cos(th3 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(3, 6) = (l3*l6*cos(th3 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(3, 7) = (l3*l7*cos(th3 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(3, 8) = (l3*l8*cos(th3 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(3, 9) = (l3*l9*cos(th3 - th9)*(m9 + 2*m10))/2;
A(3, 10) = (l3*l10*m10*cos(th3 - th10))/2;
A(4, 1) = (l1*l4*cos(th1 - th4)*(m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(4, 2) = (l2*l4*cos(th2 - th4)*(m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(4, 3) = (l3*l4*cos(th3 - th4)*(m4 + 2*m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(4, 4) = I4 + (l4^2*m4)/4 + l4^2*m5 + l4^2*m6 + l4^2*m7 + l4^2*m8 + l4^2*m9 + l4^2*m10;
A(4, 5) = (l4*l5*cos(th4 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(4, 6) = (l4*l6*cos(th4 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(4, 7) = (l4*l7*cos(th4 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(4, 8) = (l4*l8*cos(th4 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(4, 9) = (l4*l9*cos(th4 - th9)*(m9 + 2*m10))/2;
A(4, 10) = (l4*l10*m10*cos(th4 - th10))/2;
A(5, 1) = (l1*l5*cos(th1 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(5, 2) = (l2*l5*cos(th2 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(5, 3) = (l3*l5*cos(th3 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(5, 4) = (l4*l5*cos(th4 - th5)*(m5 + 2*m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(5, 5) = I5 + (l5^2*m5)/4 + l5^2*m6 + l5^2*m7 + l5^2*m8 + l5^2*m9 + l5^2*m10;
A(5, 6) = (l5*l6*cos(th5 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(5, 7) = (l5*l7*cos(th5 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(5, 8) = (l5*l8*cos(th5 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(5, 9) = (l5*l9*cos(th5 - th9)*(m9 + 2*m10))/2;
A(5, 10) = (l5*l10*m10*cos(th5 - th10))/2;
A(6, 1) = (l1*l6*cos(th1 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(6, 2) = (l2*l6*cos(th2 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(6, 3) = (l3*l6*cos(th3 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(6, 4) = (l4*l6*cos(th4 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(6, 5) = (l5*l6*cos(th5 - th6)*(m6 + 2*m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(6, 6) = I6 + (l6^2*m6)/4 + l6^2*m7 + l6^2*m8 + l6^2*m9 + l6^2*m10;
A(6, 7) = (l6*l7*cos(th6 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(6, 8) = (l6*l8*cos(th6 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(6, 9) = (l6*l9*cos(th6 - th9)*(m9 + 2*m10))/2;
A(6, 10) = (l6*l10*m10*cos(th6 - th10))/2;
A(7, 1) = (l1*l7*cos(th1 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(7, 2) = (l2*l7*cos(th2 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(7, 3) = (l3*l7*cos(th3 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(7, 4) = (l4*l7*cos(th4 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(7, 5) = (l5*l7*cos(th5 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(7, 6) = (l6*l7*cos(th6 - th7)*(m7 + 2*m8 + 2*m9 + 2*m10))/2;
A(7, 7) = I7 + (l7^2*m7)/4 + l7^2*m8 + l7^2*m9 + l7^2*m10;
A(7, 8) = (l7*l8*cos(th7 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(7, 9) = (l7*l9*cos(th7 - th9)*(m9 + 2*m10))/2;
A(7, 10) = (l7*l10*m10*cos(th7 - th10))/2;
A(8, 1) = (l1*l8*cos(th1 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 2) = (l2*l8*cos(th2 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 3) = (l3*l8*cos(th3 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 4) = (l4*l8*cos(th4 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 5) = (l5*l8*cos(th5 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 6) = (l6*l8*cos(th6 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 7) = (l7*l8*cos(th7 - th8)*(m8 + 2*m9 + 2*m10))/2;
A(8, 8) = I8 + (l8^2*m8)/4 + l8^2*m9 + l8^2*m10;
A(8, 9) = (l8*l9*cos(th8 - th9)*(m9 + 2*m10))/2;
A(8, 10) = (l8*l10*m10*cos(th8 - th10))/2;
A(9, 1) = (l1*l9*cos(th1 - th9)*(m9 + 2*m10))/2;
A(9, 2) = (l2*l9*cos(th2 - th9)*(m9 + 2*m10))/2;
A(9, 3) = (l3*l9*cos(th3 - th9)*(m9 + 2*m10))/2;
A(9, 4) = (l4*l9*cos(th4 - th9)*(m9 + 2*m10))/2;
A(9, 5) = (l5*l9*cos(th5 - th9)*(m9 + 2*m10))/2;
A(9, 6) = (l6*l9*cos(th6 - th9)*(m9 + 2*m10))/2;
A(9, 7) = (l7*l9*cos(th7 - th9)*(m9 + 2*m10))/2;
A(9, 8) = (l8*l9*cos(th8 - th9)*(m9 + 2*m10))/2;
A(9, 9) = I9 + (l9^2*m9)/4 + l9^2*m10;
A(9, 10) = (l9*l10*m10*cos(th9 - th10))/2;
A(10, 1) = (l1*l10*m10*cos(th1 - th10))/2;
A(10, 2) = (l2*l10*m10*cos(th2 - th10))/2;
A(10, 3) = (l3*l10*m10*cos(th3 - th10))/2;
A(10, 4) = (l4*l10*m10*cos(th4 - th10))/2;
A(10, 5) = (l5*l10*m10*cos(th5 - th10))/2;
A(10, 6) = (l6*l10*m10*cos(th6 - th10))/2;
A(10, 7) = (l7*l10*m10*cos(th7 - th10))/2;
A(10, 8) = (l8*l10*m10*cos(th8 - th10))/2;
A(10, 9) = (l9*l10*m10*cos(th9 - th10))/2;
A(10, 10) = I10 + (l10^2*m10)/4;
b(1) = -(l1*(g*m1*sin(th1) + 2*g*m2*sin(th1) + 2*g*m3*sin(th1) + 2*g*m4*sin(th1) + 2*g*m5*sin(th1) + 2*g*m6*sin(th1) + 2*g*m7*sin(th1) + 2*g*m8*sin(th1) + 2*g*m9*sin(th1) + 2*g*m10*sin(th1) + l2*m2*thd2^2*sin(th1 - th2) + 2*l2*m3*thd2^2*sin(th1 - th2) + 2*l2*m4*thd2^2*sin(th1 - th2) + 2*l2*m5*thd2^2*sin(th1 - th2) + 2*l2*m6*thd2^2*sin(th1 - th2) + l3*m3*thd3^2*sin(th1 - th3) + 2*l2*m7*thd2^2*sin(th1 - th2) + 2*l3*m4*thd3^2*sin(th1 - th3) + 2*l2*m8*thd2^2*sin(th1 - th2) + 2*l3*m5*thd3^2*sin(th1 - th3) + 2*l2*m9*thd2^2*sin(th1 - th2) + 2*l3*m6*thd3^2*sin(th1 - th3) + 2*l2*m10*thd2^2*sin(th1 - th2) + 2*l3*m7*thd3^2*sin(th1 - th3) + l4*m4*thd4^2*sin(th1 - th4) + 2*l3*m8*thd3^2*sin(th1 - th3) + 2*l4*m5*thd4^2*sin(th1 - th4) + 2*l3*m9*thd3^2*sin(th1 - th3) + 2*l4*m6*thd4^2*sin(th1 - th4) + 2*l3*m10*thd3^2*sin(th1 - th3) + 2*l4*m7*thd4^2*sin(th1 - th4) + 2*l4*m8*thd4^2*sin(th1 - th4) + l5*m5*thd5^2*sin(th1 - th5) + 2*l4*m9*thd4^2*sin(th1 - th4) + 2*l5*m6*thd5^2*sin(th1 - th5) + 2*l4*m10*thd4^2*sin(th1 - th4) + 2*l5*m7*thd5^2*sin(th1 - th5) + 2*l5*m8*thd5^2*sin(th1 - th5) + 2*l5*m9*thd5^2*sin(th1 - th5) + l6*m6*thd6^2*sin(th1 - th6) + 2*l5*m10*thd5^2*sin(th1 - th5) + 2*l6*m7*thd6^2*sin(th1 - th6) + 2*l6*m8*thd6^2*sin(th1 - th6) + 2*l6*m9*thd6^2*sin(th1 - th6) + 2*l6*m10*thd6^2*sin(th1 - th6) + l7*m7*thd7^2*sin(th1 - th7) + 2*l7*m8*thd7^2*sin(th1 - th7) + 2*l7*m9*thd7^2*sin(th1 - th7) + 2*l7*m10*thd7^2*sin(th1 - th7) + l8*m8*thd8^2*sin(th1 - th8) + 2*l8*m9*thd8^2*sin(th1 - th8) + 2*l8*m10*thd8^2*sin(th1 - th8) + l9*m9*thd9^2*sin(th1 - th9) + 2*l9*m10*thd9^2*sin(th1 - th9) + l10*m10*thd10^2*sin(th1 - th10)))/2;
b(2) = -(l2*(g*m2*sin(th2) + 2*g*m3*sin(th2) + 2*g*m4*sin(th2) + 2*g*m5*sin(th2) + 2*g*m6*sin(th2) + 2*g*m7*sin(th2) + 2*g*m8*sin(th2) + 2*g*m9*sin(th2) + 2*g*m10*sin(th2) - l1*m2*thd1^2*sin(th1 - th2) - 2*l1*m3*thd1^2*sin(th1 - th2) - 2*l1*m4*thd1^2*sin(th1 - th2) - 2*l1*m5*thd1^2*sin(th1 - th2) - 2*l1*m6*thd1^2*sin(th1 - th2) - 2*l1*m7*thd1^2*sin(th1 - th2) - 2*l1*m8*thd1^2*sin(th1 - th2) - 2*l1*m9*thd1^2*sin(th1 - th2) + l3*m3*thd3^2*sin(th2 - th3) - 2*l1*m10*thd1^2*sin(th1 - th2) + 2*l3*m4*thd3^2*sin(th2 - th3) + 2*l3*m5*thd3^2*sin(th2 - th3) + 2*l3*m6*thd3^2*sin(th2 - th3) + 2*l3*m7*thd3^2*sin(th2 - th3) + l4*m4*thd4^2*sin(th2 - th4) + 2*l3*m8*thd3^2*sin(th2 - th3) + 2*l4*m5*thd4^2*sin(th2 - th4) + 2*l3*m9*thd3^2*sin(th2 - th3) + 2*l4*m6*thd4^2*sin(th2 - th4) + 2*l3*m10*thd3^2*sin(th2 - th3) + 2*l4*m7*thd4^2*sin(th2 - th4) + 2*l4*m8*thd4^2*sin(th2 - th4) + l5*m5*thd5^2*sin(th2 - th5) + 2*l4*m9*thd4^2*sin(th2 - th4) + 2*l5*m6*thd5^2*sin(th2 - th5) + 2*l4*m10*thd4^2*sin(th2 - th4) + 2*l5*m7*thd5^2*sin(th2 - th5) + 2*l5*m8*thd5^2*sin(th2 - th5) + 2*l5*m9*thd5^2*sin(th2 - th5) + l6*m6*thd6^2*sin(th2 - th6) + 2*l5*m10*thd5^2*sin(th2 - th5) + 2*l6*m7*thd6^2*sin(th2 - th6) + 2*l6*m8*thd6^2*sin(th2 - th6) + 2*l6*m9*thd6^2*sin(th2 - th6) + 2*l6*m10*thd6^2*sin(th2 - th6) + l7*m7*thd7^2*sin(th2 - th7) + 2*l7*m8*thd7^2*sin(th2 - th7) + 2*l7*m9*thd7^2*sin(th2 - th7) + 2*l7*m10*thd7^2*sin(th2 - th7) + l8*m8*thd8^2*sin(th2 - th8) + 2*l8*m9*thd8^2*sin(th2 - th8) + 2*l8*m10*thd8^2*sin(th2 - th8) + l9*m9*thd9^2*sin(th2 - th9) + 2*l9*m10*thd9^2*sin(th2 - th9) + l10*m10*thd10^2*sin(th2 - th10)))/2;
b(3) = -(l3*(g*m3*sin(th3) + 2*g*m4*sin(th3) + 2*g*m5*sin(th3) + 2*g*m6*sin(th3) + 2*g*m7*sin(th3) + 2*g*m8*sin(th3) + 2*g*m9*sin(th3) + 2*g*m10*sin(th3) - l1*m3*thd1^2*sin(th1 - th3) - 2*l1*m4*thd1^2*sin(th1 - th3) - 2*l1*m5*thd1^2*sin(th1 - th3) - 2*l1*m6*thd1^2*sin(th1 - th3) - l2*m3*thd2^2*sin(th2 - th3) - 2*l1*m7*thd1^2*sin(th1 - th3) - 2*l2*m4*thd2^2*sin(th2 - th3) - 2*l1*m8*thd1^2*sin(th1 - th3) - 2*l2*m5*thd2^2*sin(th2 - th3) - 2*l1*m9*thd1^2*sin(th1 - th3) - 2*l2*m6*thd2^2*sin(th2 - th3) - 2*l1*m10*thd1^2*sin(th1 - th3) - 2*l2*m7*thd2^2*sin(th2 - th3) - 2*l2*m8*thd2^2*sin(th2 - th3) - 2*l2*m9*thd2^2*sin(th2 - th3) - 2*l2*m10*thd2^2*sin(th2 - th3) + l4*m4*thd4^2*sin(th3 - th4) + 2*l4*m5*thd4^2*sin(th3 - th4) + 2*l4*m6*thd4^2*sin(th3 - th4) + 2*l4*m7*thd4^2*sin(th3 - th4) + 2*l4*m8*thd4^2*sin(th3 - th4) + l5*m5*thd5^2*sin(th3 - th5) + 2*l4*m9*thd4^2*sin(th3 - th4) + 2*l5*m6*thd5^2*sin(th3 - th5) + 2*l4*m10*thd4^2*sin(th3 - th4) + 2*l5*m7*thd5^2*sin(th3 - th5) + 2*l5*m8*thd5^2*sin(th3 - th5) + 2*l5*m9*thd5^2*sin(th3 - th5) + l6*m6*thd6^2*sin(th3 - th6) + 2*l5*m10*thd5^2*sin(th3 - th5) + 2*l6*m7*thd6^2*sin(th3 - th6) + 2*l6*m8*thd6^2*sin(th3 - th6) + 2*l6*m9*thd6^2*sin(th3 - th6) + 2*l6*m10*thd6^2*sin(th3 - th6) + l7*m7*thd7^2*sin(th3 - th7) + 2*l7*m8*thd7^2*sin(th3 - th7) + 2*l7*m9*thd7^2*sin(th3 - th7) + 2*l7*m10*thd7^2*sin(th3 - th7) + l8*m8*thd8^2*sin(th3 - th8) + 2*l8*m9*thd8^2*sin(th3 - th8) + 2*l8*m10*thd8^2*sin(th3 - th8) + l9*m9*thd9^2*sin(th3 - th9) + 2*l9*m10*thd9^2*sin(th3 - th9) + l10*m10*thd10^2*sin(th3 - th10)))/2;
b(4) = -(l4*(g*m4*sin(th4) + 2*g*m5*sin(th4) + 2*g*m6*sin(th4) + 2*g*m7*sin(th4) + 2*g*m8*sin(th4) + 2*g*m9*sin(th4) + 2*g*m10*sin(th4) - l1*m4*thd1^2*sin(th1 - th4) - 2*l1*m5*thd1^2*sin(th1 - th4) - 2*l1*m6*thd1^2*sin(th1 - th4) - 2*l1*m7*thd1^2*sin(th1 - th4) - l2*m4*thd2^2*sin(th2 - th4) - 2*l1*m8*thd1^2*sin(th1 - th4) - 2*l2*m5*thd2^2*sin(th2 - th4) - 2*l1*m9*thd1^2*sin(th1 - th4) - 2*l2*m6*thd2^2*sin(th2 - th4) - 2*l1*m10*thd1^2*sin(th1 - th4) - 2*l2*m7*thd2^2*sin(th2 - th4) - l3*m4*thd3^2*sin(th3 - th4) - 2*l2*m8*thd2^2*sin(th2 - th4) - 2*l3*m5*thd3^2*sin(th3 - th4) - 2*l2*m9*thd2^2*sin(th2 - th4) - 2*l3*m6*thd3^2*sin(th3 - th4) - 2*l2*m10*thd2^2*sin(th2 - th4) - 2*l3*m7*thd3^2*sin(th3 - th4) - 2*l3*m8*thd3^2*sin(th3 - th4) - 2*l3*m9*thd3^2*sin(th3 - th4) - 2*l3*m10*thd3^2*sin(th3 - th4) + l5*m5*thd5^2*sin(th4 - th5) + 2*l5*m6*thd5^2*sin(th4 - th5) + 2*l5*m7*thd5^2*sin(th4 - th5) + 2*l5*m8*thd5^2*sin(th4 - th5) + 2*l5*m9*thd5^2*sin(th4 - th5) + l6*m6*thd6^2*sin(th4 - th6) + 2*l5*m10*thd5^2*sin(th4 - th5) + 2*l6*m7*thd6^2*sin(th4 - th6) + 2*l6*m8*thd6^2*sin(th4 - th6) + 2*l6*m9*thd6^2*sin(th4 - th6) + 2*l6*m10*thd6^2*sin(th4 - th6) + l7*m7*thd7^2*sin(th4 - th7) + 2*l7*m8*thd7^2*sin(th4 - th7) + 2*l7*m9*thd7^2*sin(th4 - th7) + 2*l7*m10*thd7^2*sin(th4 - th7) + l8*m8*thd8^2*sin(th4 - th8) + 2*l8*m9*thd8^2*sin(th4 - th8) + 2*l8*m10*thd8^2*sin(th4 - th8) + l9*m9*thd9^2*sin(th4 - th9) + 2*l9*m10*thd9^2*sin(th4 - th9) + l10*m10*thd10^2*sin(th4 - th10)))/2;
b(5) = (l5*(l1*m5*thd1^2*sin(th1 - th5) - 2*g*m6*sin(th5) - 2*g*m7*sin(th5) - 2*g*m8*sin(th5) - 2*g*m9*sin(th5) - 2*g*m10*sin(th5) - g*m5*sin(th5) + 2*l1*m6*thd1^2*sin(th1 - th5) + 2*l1*m7*thd1^2*sin(th1 - th5) + 2*l1*m8*thd1^2*sin(th1 - th5) + l2*m5*thd2^2*sin(th2 - th5) + 2*l1*m9*thd1^2*sin(th1 - th5) + 2*l2*m6*thd2^2*sin(th2 - th5) + 2*l1*m10*thd1^2*sin(th1 - th5) + 2*l2*m7*thd2^2*sin(th2 - th5) + 2*l2*m8*thd2^2*sin(th2 - th5) + l3*m5*thd3^2*sin(th3 - th5) + 2*l2*m9*thd2^2*sin(th2 - th5) + 2*l3*m6*thd3^2*sin(th3 - th5) + 2*l2*m10*thd2^2*sin(th2 - th5) + 2*l3*m7*thd3^2*sin(th3 - th5) + 2*l3*m8*thd3^2*sin(th3 - th5) + l4*m5*thd4^2*sin(th4 - th5) + 2*l3*m9*thd3^2*sin(th3 - th5) + 2*l4*m6*thd4^2*sin(th4 - th5) + 2*l3*m10*thd3^2*sin(th3 - th5) + 2*l4*m7*thd4^2*sin(th4 - th5) + 2*l4*m8*thd4^2*sin(th4 - th5) + 2*l4*m9*thd4^2*sin(th4 - th5) + 2*l4*m10*thd4^2*sin(th4 - th5) - l6*m6*thd6^2*sin(th5 - th6) - 2*l6*m7*thd6^2*sin(th5 - th6) - 2*l6*m8*thd6^2*sin(th5 - th6) - 2*l6*m9*thd6^2*sin(th5 - th6) - 2*l6*m10*thd6^2*sin(th5 - th6) - l7*m7*thd7^2*sin(th5 - th7) - 2*l7*m8*thd7^2*sin(th5 - th7) - 2*l7*m9*thd7^2*sin(th5 - th7) - 2*l7*m10*thd7^2*sin(th5 - th7) - l8*m8*thd8^2*sin(th5 - th8) - 2*l8*m9*thd8^2*sin(th5 - th8) - 2*l8*m10*thd8^2*sin(th5 - th8) - l9*m9*thd9^2*sin(th5 - th9) - 2*l9*m10*thd9^2*sin(th5 - th9) - l10*m10*thd10^2*sin(th5 - th10)))/2;
b(6) = (l6*(l1*m6*thd1^2*sin(th1 - th6) - 2*g*m7*sin(th6) - 2*g*m8*sin(th6) - 2*g*m9*sin(th6) - 2*g*m10*sin(th6) - g*m6*sin(th6) + 2*l1*m7*thd1^2*sin(th1 - th6) + 2*l1*m8*thd1^2*sin(th1 - th6) + 2*l1*m9*thd1^2*sin(th1 - th6) + l2*m6*thd2^2*sin(th2 - th6) + 2*l1*m10*thd1^2*sin(th1 - th6) + 2*l2*m7*thd2^2*sin(th2 - th6) + 2*l2*m8*thd2^2*sin(th2 - th6) + 2*l2*m9*thd2^2*sin(th2 - th6) + l3*m6*thd3^2*sin(th3 - th6) + 2*l2*m10*thd2^2*sin(th2 - th6) + 2*l3*m7*thd3^2*sin(th3 - th6) + 2*l3*m8*thd3^2*sin(th3 - th6) + 2*l3*m9*thd3^2*sin(th3 - th6) + l4*m6*thd4^2*sin(th4 - th6) + 2*l3*m10*thd3^2*sin(th3 - th6) + 2*l4*m7*thd4^2*sin(th4 - th6) + 2*l4*m8*thd4^2*sin(th4 - th6) + 2*l4*m9*thd4^2*sin(th4 - th6) + l5*m6*thd5^2*sin(th5 - th6) + 2*l4*m10*thd4^2*sin(th4 - th6) + 2*l5*m7*thd5^2*sin(th5 - th6) + 2*l5*m8*thd5^2*sin(th5 - th6) + 2*l5*m9*thd5^2*sin(th5 - th6) + 2*l5*m10*thd5^2*sin(th5 - th6) - l7*m7*thd7^2*sin(th6 - th7) - 2*l7*m8*thd7^2*sin(th6 - th7) - 2*l7*m9*thd7^2*sin(th6 - th7) - 2*l7*m10*thd7^2*sin(th6 - th7) - l8*m8*thd8^2*sin(th6 - th8) - 2*l8*m9*thd8^2*sin(th6 - th8) - 2*l8*m10*thd8^2*sin(th6 - th8) - l9*m9*thd9^2*sin(th6 - th9) - 2*l9*m10*thd9^2*sin(th6 - th9) - l10*m10*thd10^2*sin(th6 - th10)))/2;
b(7) = (l7*(l1*m7*thd1^2*sin(th1 - th7) - 2*g*m8*sin(th7) - 2*g*m9*sin(th7) - 2*g*m10*sin(th7) - g*m7*sin(th7) + 2*l1*m8*thd1^2*sin(th1 - th7) + 2*l1*m9*thd1^2*sin(th1 - th7) + 2*l1*m10*thd1^2*sin(th1 - th7) + l2*m7*thd2^2*sin(th2 - th7) + 2*l2*m8*thd2^2*sin(th2 - th7) + 2*l2*m9*thd2^2*sin(th2 - th7) + 2*l2*m10*thd2^2*sin(th2 - th7) + l3*m7*thd3^2*sin(th3 - th7) + 2*l3*m8*thd3^2*sin(th3 - th7) + 2*l3*m9*thd3^2*sin(th3 - th7) + 2*l3*m10*thd3^2*sin(th3 - th7) + l4*m7*thd4^2*sin(th4 - th7) + 2*l4*m8*thd4^2*sin(th4 - th7) + 2*l4*m9*thd4^2*sin(th4 - th7) + 2*l4*m10*thd4^2*sin(th4 - th7) + l5*m7*thd5^2*sin(th5 - th7) + 2*l5*m8*thd5^2*sin(th5 - th7) + 2*l5*m9*thd5^2*sin(th5 - th7) + 2*l5*m10*thd5^2*sin(th5 - th7) + l6*m7*thd6^2*sin(th6 - th7) + 2*l6*m8*thd6^2*sin(th6 - th7) + 2*l6*m9*thd6^2*sin(th6 - th7) + 2*l6*m10*thd6^2*sin(th6 - th7) - l8*m8*thd8^2*sin(th7 - th8) - 2*l8*m9*thd8^2*sin(th7 - th8) - 2*l8*m10*thd8^2*sin(th7 - th8) - l9*m9*thd9^2*sin(th7 - th9) - 2*l9*m10*thd9^2*sin(th7 - th9) - l10*m10*thd10^2*sin(th7 - th10)))/2;
b(8) = (l8*(l1*m8*thd1^2*sin(th1 - th8) - 2*g*m9*sin(th8) - 2*g*m10*sin(th8) - g*m8*sin(th8) + 2*l1*m9*thd1^2*sin(th1 - th8) + 2*l1*m10*thd1^2*sin(th1 - th8) + l2*m8*thd2^2*sin(th2 - th8) + 2*l2*m9*thd2^2*sin(th2 - th8) + 2*l2*m10*thd2^2*sin(th2 - th8) + l3*m8*thd3^2*sin(th3 - th8) + 2*l3*m9*thd3^2*sin(th3 - th8) + 2*l3*m10*thd3^2*sin(th3 - th8) + l4*m8*thd4^2*sin(th4 - th8) + 2*l4*m9*thd4^2*sin(th4 - th8) + 2*l4*m10*thd4^2*sin(th4 - th8) + l5*m8*thd5^2*sin(th5 - th8) + 2*l5*m9*thd5^2*sin(th5 - th8) + 2*l5*m10*thd5^2*sin(th5 - th8) + l6*m8*thd6^2*sin(th6 - th8) + 2*l6*m9*thd6^2*sin(th6 - th8) + 2*l6*m10*thd6^2*sin(th6 - th8) + l7*m8*thd7^2*sin(th7 - th8) + 2*l7*m9*thd7^2*sin(th7 - th8) + 2*l7*m10*thd7^2*sin(th7 - th8) - l9*m9*thd9^2*sin(th8 - th9) - 2*l9*m10*thd9^2*sin(th8 - th9) - l10*m10*thd10^2*sin(th8 - th10)))/2;
b(9) = (l9*(l1*m9*thd1^2*sin(th1 - th9) - 2*g*m10*sin(th9) - g*m9*sin(th9) + 2*l1*m10*thd1^2*sin(th1 - th9) + l2*m9*thd2^2*sin(th2 - th9) + 2*l2*m10*thd2^2*sin(th2 - th9) + l3*m9*thd3^2*sin(th3 - th9) + 2*l3*m10*thd3^2*sin(th3 - th9) + l4*m9*thd4^2*sin(th4 - th9) + 2*l4*m10*thd4^2*sin(th4 - th9) + l5*m9*thd5^2*sin(th5 - th9) + 2*l5*m10*thd5^2*sin(th5 - th9) + l6*m9*thd6^2*sin(th6 - th9) + 2*l6*m10*thd6^2*sin(th6 - th9) + l7*m9*thd7^2*sin(th7 - th9) + 2*l7*m10*thd7^2*sin(th7 - th9) + l8*m9*thd8^2*sin(th8 - th9) + 2*l8*m10*thd8^2*sin(th8 - th9) - l10*m10*thd10^2*sin(th9 - th10)))/2;
b(10) = (l10*m10*(l1*thd1^2*sin(th1 - th10) - g*sin(th10) + l2*thd2^2*sin(th2 - th10) + l3*thd3^2*sin(th3 - th10) + l4*thd4^2*sin(th4 - th10) + l5*thd5^2*sin(th5 - th10) + l6*thd6^2*sin(th6 - th10) + l7*thd7^2*sin(th7 - th10) + l8*thd8^2*sin(th8 - th10) + l9*thd9^2*sin(th9 - th10)))/2;
vec = A\b;

thdd1 = vec(1);
thdd2 = vec(2);
thdd3 = vec(3);
thdd4 = vec(4);
thdd5 = vec(5);
thdd6 = vec(6);
thdd7 = vec(7);
thdd8 = vec(8);
thdd9 = vec(9);
thdd10 = vec(10);

zdot = [thd1; thd2; thd3; thd4; thd5; thd6; thd7; thd8; thd9; thd10; thdd1; thdd2; thdd3; thdd4; thdd5; thdd6; thdd7; thdd8; thdd9; thdd10; ];
end
